(this["webpackJsonprealtime-transcribe-react"]=this["webpackJsonprealtime-transcribe-react"]||[]).push([[0],{300:function(e,n,t){},302:function(e,n,t){},308:function(e,n){},310:function(e,n){},320:function(e,n){},322:function(e,n){},348:function(e,n){},350:function(e,n){},351:function(e,n){},356:function(e,n){},358:function(e,n){},364:function(e,n){},366:function(e,n){},385:function(e,n){},397:function(e,n){},400:function(e,n){},475:function(e,n,t){var a={"./amplify-amazon-button_5.entry.js":[510,16],"./amplify-auth-container.entry.js":[511,17],"./amplify-auth-fields_9.entry.js":[512,18],"./amplify-authenticator.entry.js":[513,5],"./amplify-button_3.entry.js":[514,19],"./amplify-chatbot.entry.js":[515,4],"./amplify-checkbox.entry.js":[516,20],"./amplify-confirm-sign-in_7.entry.js":[517,6],"./amplify-container.entry.js":[518,21],"./amplify-federated-buttons_2.entry.js":[519,22],"./amplify-federated-sign-in.entry.js":[520,23],"./amplify-form-field_4.entry.js":[521,24],"./amplify-greetings.entry.js":[522,25],"./amplify-icon-button.entry.js":[523,26],"./amplify-icon.entry.js":[524,7],"./amplify-link.entry.js":[525,27],"./amplify-nav_2.entry.js":[526,28],"./amplify-photo-picker.entry.js":[527,29],"./amplify-picker.entry.js":[528,30],"./amplify-radio-button_3.entry.js":[529,8],"./amplify-s3-album.entry.js":[530,9],"./amplify-s3-image-picker.entry.js":[531,10],"./amplify-s3-image.entry.js":[532,11],"./amplify-s3-text-picker.entry.js":[533,12],"./amplify-s3-text.entry.js":[534,13],"./amplify-select-mfa-type.entry.js":[535,31],"./amplify-sign-in-button.entry.js":[536,14],"./amplify-tooltip.entry.js":[537,32]};function r(e){if(!t.o(a,e))return Promise.resolve().then((function(){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}));var n=a[e],r=n[0];return t.e(n[1]).then((function(){return t(r)}))}r.keys=function(){return Object.keys(a)},r.id=475,e.exports=r},506:function(e,n,t){"use strict";t.r(n);var a,r,c,i,o,s=t(0),l=t.n(s),u=t(124),j=t.n(u),d=(t(300),t(72)),b=t(100),f=t(34),p=t(56),O=t(25),h=(t(301),t(302),t(569)),m=t(176),x=t(565),g=t(566),k=t(284),y=t(50),v=t(51),S=t(128),w=Object(s.createContext)(void 0),C=Object(s.createContext)({speakers:{},setSpeakers:function(e){return null}}),T=t(571),I=function(){return Object(s.useContext)(w)},N=t(97),A=t(269),P=t(5),_=v.a.div(a||(a=Object(y.a)(["\n  display: flex;\n  width: auto;\n  align-items: center;\n"]))),M=function(e){var n=e.setCredential,t=e.setStop,a=e.saveToQuip,r=I(),c=Object(s.useState)(!1),i=Object(O.a)(c,2),o=i[0],l=i[1],u=Object(s.useCallback)((function(){var e;r&&(l(!0),t(!1),(e="/start-session",N.a.currentSession().then((function(n){var t=n.getIdToken().getJwtToken();return A.a.get("SAMAPI",e,{headers:{Authorization:"Bearer "+t}})}))).then((function(e){n(e.credentials),l(!1)})).catch((function(){return l(!1)})))}),[r,n]),j=Object(s.useCallback)((function(){r&&t(!0)}),[r,t]),d=Object(s.useCallback)((function(){var e=prompt("Quip document URL:");e&&a(e)}),[a]);return Object(P.jsxs)(_,{children:[o&&Object(P.jsx)(S.ClipLoader,{color:"white",size:20}),Object(P.jsx)(h.b,{disabled:!r,onClick:d,children:"Save to Quip"}),Object(P.jsx)(h.b,{disabled:!r,onClick:u,children:"Start"}),Object(P.jsx)(h.b,{disabled:!r,onClick:j,children:"Stop"})]})},E=v.a.div(r||(r=Object(y.a)(["\n  height: 100%;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n\n  & > span {\n    margin: 0 1rem;\n  }\n"]))),F=function(){var e,n=I();return n?Object(P.jsxs)(E,{children:[Object(P.jsx)("span",{children:null===n||void 0===n||null===(e=n.attributes)||void 0===e?void 0:e.email}),Object(P.jsx)(h.c,{})]}):null},z=v.a.div(c||(c=Object(y.a)(["\n  display: flex;\n  position: fixed;\n  width: 100%;\n  bottom: 0;\n  background-color: orange;\n  justify-content: space-between;\n  color: white;\n"]))),D=function(e){return Object(P.jsxs)(z,{children:[Object(P.jsx)(F,{}),Object(P.jsx)(M,Object(f.a)({},e))]})},B=t(174),L=t(173),Q=t(279),U=t.n(Q),J=t(567),K=t(568),R=v.a.div(i||(i=Object(y.a)(["\n  display: flex;\n  border: solid 1px;\n  border-radius: 5px;\n  margin: 1rem;\n\n  .meta {\n    flex-shrink: 0;\n    width: 120px;\n    position: relative;\n    text-align: center;\n    min-height: 50px;\n\n    .speaking {\n      margin-top: 5px;\n    }\n\n    .speaker {\n      width: 120px;\n      height: 80px;\n\n      .speaker-icon {\n        font-size: 30px;\n      }\n\n      .speaker-label {\n        font-weight: bold;\n        cursor: pointer;\n        font-size: 1rem;\n\n        .btn {\n          /* erase the styles brought by react-bootstrap */\n          background-color: unset !important;\n          border: unset !important;\n          color: black;\n        }\n      }\n    }\n  }\n\n  .content {\n    padding: 5px;\n    flex-grow: 1;\n    position: relative;\n\n    .form-control {\n      background-color: transparent !important;\n    }\n\n    .timestamp {\n      position: absolute;\n      font-size: 0.6rem;\n      bottom: 5px;\n      left: 10px;\n    }\n  }\n"]))),W=function(e){var n=e.dialog,t=e.partial,a=e.color,r=void 0===a?"#fff":a,c=e.speakerOptions,i=e.onSetSpeaker,o=e.updateDialog,l=Object(s.useContext)(C),u=l.speakers,j=(l.setSpeakers,Object(s.useState)(!1)),d=Object(O.a)(j,2),b=d[0],f=d[1],p=U()(r),h=n&&(u[n.speaker]||String(n.speaker));return Object(P.jsxs)(R,{style:{borderColor:r},children:[Object(P.jsxs)("div",{className:"meta",style:{backgroundColor:r},children:[n&&Object(P.jsx)(P.Fragment,{children:Object(P.jsxs)("div",{className:"speaker",children:[Object(P.jsx)("div",{className:"speaker-icon",children:Object(P.jsx)(L.a,{icon:B.b})}),Object(P.jsx)("div",{className:"speaker-label",onClick:function(){return f(!0)},children:Object(P.jsxs)(J.a,{children:[Object(P.jsx)(J.a.Toggle,{children:h}),Object(P.jsx)(J.a.Menu,{show:b,children:c.map((function(e){return Object(P.jsx)(J.a.Item,{href:"#",onClick:function(){return i(n,e)},children:e},e)}))})]})})]})}),t&&Object(P.jsx)("div",{className:"speaking",children:Object(P.jsx)(S.BeatLoader,{})})]}),Object(P.jsxs)("div",{className:"content",style:{backgroundColor:p.lighten(.2).hex()},contentEditable:!0,children:[Object(P.jsx)(K.a.Control,{value:n?n.words:t,onChange:function(e){o&&n&&o(n.dialogId,e.target.value)}}),n&&Object(P.jsxs)("div",{className:"timestamp",children:[Object(P.jsx)(L.a,{icon:B.a})," ",n.startTime.toFixed(2),"s"]})]})]})},q=l.a.memo(W),G=t(175),H=t.n(G),V=t(570),X=t(283),Y=function(e){var n=e.children,t=e.onChange,a=Object(s.useState)(n),r=Object(O.a)(a,2),c=r[0],i=r[1],o=Object(s.useState)(!1),l=Object(O.a)(o,2),u=l[0],j=l[1];return Object(s.useEffect)((function(){i(n)}),[n]),u?Object(P.jsxs)("div",{children:[Object(P.jsx)(K.a.Control,{value:c,onChange:function(e){return i(e.target.value)}}),Object(P.jsx)(X.a,{onClick:function(){i(n),j(!1)},children:"Cancel"})," ",Object(P.jsx)(X.a,{onClick:function(){t(c),j(!1)},children:"Save"})]}):Object(P.jsx)("span",{onClick:function(){return j(!0)},children:c})},Z=v.a.div(o||(o=Object(y.a)(["\n  position: fixed;\n  right: 0;\n  padding: 5px;\n  width: 25%;\n"]))),$=function(e){var n=e.speakerNames,t=e.onNameChange,a=e.unallocatedSpeakerNames,r=e.addNewSpeaker,c=Object(s.useState)(""),i=Object(O.a)(c,2),o=i[0],l=i[1];return Object(P.jsxs)(Z,{children:[Object(P.jsx)("h3",{children:"Speakers"}),Object(P.jsxs)(V.a,{children:[n.map((function(e){return Object(P.jsx)(V.a.Item,{children:Object(P.jsx)(Y,{onChange:function(n){return t(e,n)},children:e})},e)})),a.map((function(e){return Object(P.jsx)(V.a.Item,{style:{background:"#ccc"},children:Object(P.jsx)(Y,{onChange:function(n){return t(e,n)},children:e})},e)}))]}),Object(P.jsx)(K.a.Control,{value:o,onChange:function(e){return l(e.target.value)}}),Object(P.jsx)(X.a,{disabled:!o,onClick:function(){o&&r(o),l("")},children:"Add Speaker"})]})},ee=[],ne=H()({count:6,lightMin:80}).map((function(e){return e.hex()})),te=function(){var e=Object(s.useState)(void 0),n=Object(O.a)(e,2),t=n[0],a=n[1];Object(s.useEffect)((function(){return Object(m.b)((function(e,n){e===m.a.SignedIn?a(n):a(void 0)}))}),[]);var r=Object(s.useState)(),c=Object(O.a)(r,2),i=c[0],o=c[1],l=Object(s.useState)(),u=Object(O.a)(l,2),j=u[0],y=u[1],v=function(e,n,t){var a=Object(s.useState)([]),r=Object(O.a)(a,2),c=r[0],i=r[1],o=Object(s.useState)(""),l=Object(O.a)(o,2),u=l[0],j=l[1],b=Object(s.useState)(),h=Object(O.a)(b,2),m=h[0],x=(h[1],Object(s.useCallback)((function(e){var n=e.Transcript.Results;if(n.length>0&&n[0].Alternatives.length>0){var t=n[0].Alternatives[0].Transcript;t=decodeURIComponent(escape(t)),n[0].IsPartial?j(t):(j(""),i((function(e){var t,a=[],r=Object(d.a)(n[0].Alternatives[0].Items);try{for(r.s();!(t=r.n()).done;){var c=t.value,i=c.Speaker,o=c.Content,s=c.Type,l=c.StartTime,u=c.EndTime,j=a.length>0?a[a.length-1]:void 0;j&&"speaker-change"!==s?(a.pop(),a.push(Object(f.a)(Object(f.a)({},j),{},{words:j.words+("pronunciation"===s?" ":"")+o,endTime:u}))):a.push({dialogId:Object(T.a)(),speaker:i,words:o,startTime:l,endTime:u})}}catch(b){r.e(b)}finally{r.f()}return[].concat(Object(p.a)(e),a)})))}}),[]));return Object(s.useEffect)((function(){e&&n&&!t?(window.handleEventStreamMessage=x,window.region=n,window.access_id=e.AccessKeyId,window.secret_key=e.SecretAccessKey,window.session_token=e.SessionToken,window.startTranscribe()):t&&(window.closeSocket(),console.log("stop button clicked"))}),[e,n,x,t]),{transcription:c,setTranscription:i,partial:u,error:m}}(j,"us-west-2",i),S=v.transcription,I=v.setTranscription,_=v.partial,M=(v.error,Object(s.useState)({})),E=Object(O.a)(M,2),F=E[0],z=E[1],B=Object(s.useState)([]),L=Object(O.a)(B,2),Q=L[0],U=L[1],J=Object(s.useMemo)((function(){return{speakers:F,setSpeakers:z}}),[F]),K=Object(p.a)(new Set(S.map((function(e){var n=e.speaker;return F[n]||String(n)})))).sort();Object(s.useEffect)((function(){U((function(e){return e.filter((function(e){return K.includes(e)})).length>0?e.filter((function(e){return!K.includes(e)})):e}))}),[K]);var R=Object(s.useMemo)((function(){return K.length>6?H()({count:K.length}).map((function(e){return e.hex()})):ne}),[K.length]),W=Object(s.useCallback)((function(e,n){var t=null;for(var a in F)if(F[a]===e){t=a;break}null===t&&K.includes(e)?t=parseInt(e):console.error("Cannot find speaker with existing name ",e),z(Object(f.a)(Object(f.a)({},F),{},Object(b.a)({},Number(t),n)))}),[F,K]),G=Object(s.useCallback)((function(e){K.includes(e)||Q.includes(e)?alert("".concat(e," already exists")):U((function(n){return[].concat(Object(p.a)(n),[e])}))}),[Q,K]),V=Object(s.useMemo)((function(){return[].concat(Object(p.a)(K),Object(p.a)(Q))}),[K,Q]),X=Object(s.useCallback)((function(e,n){var t;if(Q.includes(n))t=function(){if(0===ee.length)return ee.push(1e4),1e4;var e=ee[ee.length-1]+1;return ee.push(e),e}();else{var a=null;for(var r in F)if(F[r]===n){a=r;break}null===a&&K.includes(n)?a=parseInt(n):console.error("Cannot find speaker with existing name ",n),t=a}z((function(e){return Object(f.a)(Object(f.a)({},e),{},Object(b.a)({},t,n))})),I((function(n){var a=n.indexOf(e);return[].concat(Object(p.a)(n.slice(0,a)),[Object(f.a)(Object(f.a)({},e),{},{speaker:t})],Object(p.a)(n.slice(a+1)))}))}),[K,I,F,Q]),Y=Object(s.useCallback)((function(e){var n,t,a=function(e,n){var t,a=["# Transcribe"],r=Object(d.a)(e);try{for(r.s();!(t=r.n()).done;){var c=t.value;a.push("(".concat(c.startTime.toFixed(2),"-").concat(c.endTime.toFixed(2),") **").concat(n[c.speaker]||c.speaker,"** ").concat(c.words))}}catch(i){r.e(i)}finally{r.f()}return a.join("\n\n")}(S,F);(n="/putDocument",t={content:a,documentUrl:e},N.a.currentSession().then((function(e){var a=e.getIdToken().getJwtToken();return A.a.put("SAMAPI",n,{body:t,headers:{Authorization:"Bearer "+a}})}))).then((function(){window.open(e)})).catch((function(e){return alert(e)}))}),[S,F]),Z=Object(s.useCallback)((function(e,n){console.log("Changing content to ".concat(n,", dialogId: ").concat(e)),I((function(t){var a,r=[],c=Object(d.a)(t);try{for(c.s();!(a=c.n()).done;){var i=a.value;if(i.dialogId===e){var o=Object(f.a)(Object(f.a)({},i),{},{words:n});r.push(o)}else r.push(i)}}catch(s){c.e(s)}finally{c.f()}return r}))}),[I]);return Object(P.jsx)(h.a,{children:t&&Object(P.jsxs)(w.Provider,{value:t,children:[Object(P.jsx)("div",{children:Object(P.jsx)(x.a,{fluid:!0,style:{marginBottom:"5rem"},children:Object(P.jsxs)(g.a,{children:[Object(P.jsx)(k.a,{xs:9,children:Object(P.jsxs)(C.Provider,{value:J,children:[S.map((function(e,n){return Object(P.jsx)(q,{dialog:e,color:R[K.indexOf(F[e.speaker]||String(e.speaker))],speakerOptions:V,onSetSpeaker:X,updateDialog:Z},n)})),_&&Object(P.jsx)(q,{partial:_,speakerOptions:V,onSetSpeaker:X})]})}),Object(P.jsx)(k.a,{children:Object(P.jsx)($,{speakerNames:K,onNameChange:W,unallocatedSpeakerNames:Q,addNewSpeaker:G})})]})})}),Object(P.jsx)(D,{setCredential:y,saveToQuip:Y,setStop:o})]})})},ae=function(e){e&&e instanceof Function&&t.e(35).then(t.bind(null,584)).then((function(n){var t=n.getCLS,a=n.getFID,r=n.getFCP,c=n.getLCP,i=n.getTTFB;t(e),a(e),r(e),c(e),i(e)}))};t(168).default.configure({Auth:{identityPoolId:"us-west-2:b712e33e-583d-42df-b9fa-14325852efbf",region:"us-west-2",userPoolId:"us-west-2_gdDt1nKsQ",userPoolWebClientId:"6ihc4536tkdk627cmkomahfmkl"},API:{endpoints:[{name:"SAMAPI",endpoint:"https://3apx34jtve.execute-api.us-west-2.amazonaws.com/Prod"}]}}),j.a.render(Object(P.jsx)(l.a.StrictMode,{children:Object(P.jsx)(te,{})}),document.getElementById("root")),ae()}},[[506,2,3]]]);
//# sourceMappingURL=main.e08262d5.chunk.js.map